# 智能思维导图生成 - 测试示例

## 快速测试

### 示例 1：生成红楼梦思维导图

**用户消息：**
```
给我生成一个有关于红楼梦的思维导图
```

**AI 预期行为：**

1. **第一步：搜索** 🔍
   ```
   调用 web_search 工具
   query: "红楼梦 主要内容 知识点"
   max_results: 5
   ```
   
   返回搜索结果：
   - 红楼梦是清代作家曹雪芹创作的章回体长篇小说...
   - 主要人物包括贾宝玉、林黛玉、薛宝钗...
   - 故事情节围绕贾府的兴衰展开...
   - （更多搜索结果）

2. **第二步：整理信息** 📝
   ```
   AI 将搜索结果整理为：
   
   "红楼梦是清代作家曹雪芹创作的章回体长篇小说，也是中国古典四大名著之一。
   小说以贾、史、王、薛四大家族的兴衰为背景，以贾宝玉、林黛玉、薛宝钗的
   爱情婚姻悲剧为主线，描绘了一批举止见识出于须眉之上的闺阁佳人的人生百态。
   
   主要人物：
   - 贾宝玉：贾府的宝二爷，性格叛逆
   - 林黛玉：贾母的外孙女，才华横溢
   - 薛宝钗：薛家千金，端庄贤淑
   
   主要情节：
   - 宝黛初会
   - 宝钗扑蝶
   - 黛玉葬花
   - 宝玉挨打
   - 抄检大观园
   
   文学价值：
   - 现实主义巅峰之作
   - 对封建社会的深刻批判
   - 人物塑造丰满立体
   - 语言艺术登峰造极"
   ```

3. **第三步：生成导图** 🎨
   ```
   调用 generate_mind_map 工具
   text: [上面整理的文本内容]
   ```
   
   返回思维导图 JSON

4. **第四步：回复用户** 💬
   ```
   我已经为您生成了关于红楼梦的思维导图！
   
   导图主要包含以下内容：
   - 作品概述：作者、创作背景、文学地位
   - 主要人物：贾宝玉、林黛玉、薛宝钗及其他重要人物
   - 故事情节：重要章节和情节发展
   - 艺术特色：现实主义手法、人物塑造、语言特点
   - 文化影响：研究价值、社会意义
   
   [返回完整JSON]
   ```

---

### 示例 2：生成人工智能思维导图

**用户消息：**
```
帮我做一个人工智能的思维导图
```

**AI 执行流程：**

```
1. 搜索：web_search("人工智能 知识点 概述")
   
2. 整理结果：
   - 人工智能定义和发展历史
   - 机器学习、深度学习、强化学习
   - 计算机视觉、自然语言处理
   - 应用领域：医疗、金融、自动驾驶
   - 未来趋势和挑战
   
3. 生成导图：generate_mind_map(整理的文本)

4. 返回结果
```

---

### 示例 3：生成 Go 语言学习路线图

**用户消息：**
```
生成一个Go语言学习路线的导图
```

**AI 执行流程：**

```
1. 搜索：web_search("Go语言 学习路线 教程")
   
2. 整理结果：
   - 基础入门：语法、数据类型、控制结构
   - 进阶内容：并发编程、Goroutine、Channel
   - Web开发：Gin框架、数据库操作
   - 微服务：gRPC、服务治理
   - 实战项目：Web应用、API服务
   
3. 生成导图：generate_mind_map(整理的文本)

4. 返回结果
```

---

### 示例 4：提供详细内容生成（不搜索）

**用户消息：**
```
用以下内容生成思维导图：

Go语言是由Google开发的开源编程语言，于2009年发布。

基础语法：
- 变量声明：var、短声明(:=)
- 数据类型：基本类型、复合类型
- 函数：定义、参数、返回值

并发编程：
- Goroutine：轻量级线程
- Channel：通信机制
- Select：多路复用

标准库：
- fmt：格式化输入输出
- net/http：HTTP服务
- encoding/json：JSON处理
```

**AI 执行流程：**

```
1. AI 识别：用户已提供详细内容
   
2. 跳过搜索步骤
   
3. 直接生成：generate_mind_map(用户提供的内容)

4. 返回结果
```

---

## 测试检查清单

测试新功能时，验证以下几点：

### ✅ 功能检查

- [ ] AI 能识别主题式请求（如"生成XX的思维导图"）
- [ ] AI 正确调用 `web_search` 工具
- [ ] 搜索结果被正确返回
- [ ] AI 能整理搜索结果为连贯文本
- [ ] AI 调用 `generate_mind_map` 工具
- [ ] 返回完整的思维导图 JSON
- [ ] 导图内容与主题相关

### ✅ 日志检查

在日志中应该看到：

```
[INFO] 开始网络搜索: query=红楼梦 主要内容 知识点, maxResults=5
[INFO] 网络搜索完成，返回 5 条结果
[INFO] 开始生成思维导图，文本长度: XXX, userID: XXX
[INFO] 思维导图生成成功
```

### ✅ 质量检查

生成的思维导图应该：

- [ ] JSON 格式正确
- [ ] 包含必要的字段（title、desc、root 等）
- [ ] 节点层次结构合理（3-4层）
- [ ] 内容与主题高度相关
- [ ] 节点文本简洁明确
- [ ] UID 唯一且格式正确

---

## 调试技巧

### 1. 查看搜索结果

如果生成的导图内容不理想，检查搜索步骤：

```
问：搜索了什么关键词？
答：在日志中查找 "开始网络搜索: query=XXX"

问：搜索到了什么？
答：查看 web_search 工具返回的内容
```

### 2. 验证工具调用

确认 AI 正确使用了工具：

```bash
# 在日志中搜索工具调用
grep "web_search" app.log
grep "generate_mind_map" app.log
```

### 3. 测试不同主题

尝试各种主题，验证通用性：

```
- 文学作品：红楼梦、三国演义
- 历史事件：辛亥革命、工业革命
- 科技知识：人工智能、区块链
- 编程语言：Go、Python、Java
- 专业知识：项目管理、市场营销
```

---

## 预期结果示例

### 红楼梦思维导图结构

```json
{
  "title": "红楼梦",
  "desc": "中国古典四大名著之一",
  "layout": "mindmap",
  "root": {
    "data": {
      "text": "红楼梦",
      "uid": "root-hongloumeng"
    },
    "children": [
      {
        "data": {
          "text": "作品概述",
          "uid": "overview-001"
        },
        "children": [
          {"data": {"text": "作者：曹雪芹", "uid": "author-001"}},
          {"data": {"text": "创作年代：清代", "uid": "era-001"}},
          {"data": {"text": "文学地位：四大名著", "uid": "status-001"}}
        ]
      },
      {
        "data": {
          "text": "主要人物",
          "uid": "characters-001"
        },
        "children": [
          {"data": {"text": "贾宝玉", "uid": "char-baoyu"}},
          {"data": {"text": "林黛玉", "uid": "char-daiyu"}},
          {"data": {"text": "薛宝钗", "uid": "char-baochai"}}
        ]
      },
      // ... 更多节点
    ]
  }
}
```

---

## 常见问题

### Q1: AI 没有调用搜索工具？

**A:** 尝试更明确的提问：
- ✅ "生成红楼梦的思维导图"
- ✅ "帮我做一个XX的导图"
- ❌ "我想要一个导图"（太模糊）

### Q2: 搜索结果不理想？

**A:** 可以手动指定搜索：
```
先搜索一下红楼梦的详细介绍，然后生成思维导图
```

### Q3: 生成的导图太简单？

**A:** 
- 检查搜索结果是否足够详细
- 考虑提供更多初始内容
- 调整 `max_results` 参数（修改工具描述）

---

## 性能指标

正常情况下的预期性能：

| 指标 | 预期值 |
|------|--------|
| 搜索耗时 | 2-5秒 |
| 生成耗时 | 3-8秒 |
| 总耗时 | 5-15秒 |
| 搜索结果数 | 5条 |
| 整理文本长度 | 200-500字 |
| 导图层级 | 3-4层 |
| 节点数量 | 15-30个 |

---

## 下一步

1. **启动应用**：确保配置正确
2. **发送测试消息**：使用上述示例
3. **观察日志**：验证工具调用链
4. **检查结果**：确认导图质量
5. **调整优化**：根据实际效果微调

祝测试顺利！🚀

